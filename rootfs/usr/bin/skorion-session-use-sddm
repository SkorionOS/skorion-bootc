#! /bin/bash

set -e

CONF_FILE="/etc/sddm.conf.d/zz-skorionos-autologin.conf"

# Check if session name is provided
if [ -z "$1" ]; then
    echo "Usage: $0 <session-name>"
    exit 1
fi

session_launcher="$1"

echo "Updated user selected session to $session_launcher"

{
  echo "[Autologin]"
  echo "Session=$session_launcher"
} >"$CONF_FILE"

# Enable and restart SDDM
systemctl enable sddm
setsid sh -c 'exec systemctl restart sddm <> /dev/tty2 >&0 2>&1'